(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{512:function(n,s,e){"use strict";e.r(s);var a=e(20),t=Object(a.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("p",[n._v("Jenkins 是一个简单易用的持续集成软件平台，我们依然采用 Docker 的方式部署，docker-compose.yml 配置文件如下：")]),n._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[n._v("version: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v("'3.1'")]),n._v("\nservices:\n  jenkins:\n    restart: always\n    image: jenkinsci/jenkins\n    container_name: jenkins\n    ports:\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 发布端口")]),n._v("\n      - "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("8080")]),n._v(":8080\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 基于 JNLP 的 Jenkins 代理通过 TCP 端口 50000 与 Jenkins master 进行通信")]),n._v("\n      - "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("50000")]),n._v(":50000\n    environment:\n      TZ: Asia/Shanghai\n    volumes:\n      - ./data:/var/jenkins_home\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br")])]),s("p",[n._v("安装过程中会出现 "),s("code",[n._v("Docker")]),n._v("数据卷 权限问题，用以下命令解决：")]),n._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[n._v("chown")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[n._v("-R")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("1000")]),n._v(" /usr/local/docker/jenkins/data\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("h2",{attrs:{id:"解锁-jenkins"}},[n._v("解锁 Jenkins")]),n._v(" "),s("p",[n._v("Jenkins 第一次启动时需要输入一个初始密码用以解锁安装流程，使用"),s("code",[n._v(" docker logs jenkins")]),n._v(" 即可方便的查看到初始密码\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins.png",alt:"jenkins"}}),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins1.png",alt:"jenkins"}}),n._v(" "),s("strong",[n._v("注意：")]),n._v(" 安装时可能会因为网速等原因导致安装时间比较长，请大家耐心等待。如果长时间停留在安装页没反应，请尝试使用 F5 刷新一下。")]),n._v(" "),s("h2",{attrs:{id:"使用自定义插件的方式安装"}},[n._v("使用自定义插件的方式安装")]),n._v(" "),s("p",[n._v("插件是 Jenkins 的核心，其丰富的插件可以满足不同人群的不同需求")]),n._v(" "),s("p",[n._v("插件地址："),s("a",{attrs:{href:"https://plugins.jenkins.io/",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://plugins.jenkins.io/"),s("OutboundLink")],1)]),n._v(" "),s("p",[s("img",{attrs:{src:"/img/deployplatform/jenkins2.png",alt:"jenkins"}})]),n._v(" "),s("p",[s("strong",[n._v("注意：")]),n._v(" 除了默认勾选的插件外，一定要勾选 Publish over SSH 插件，这是我们实现持续交付的重点插件。")]),n._v(" "),s("p",[s("img",{attrs:{src:"/img/deployplatform/jenkins3.png",alt:"jenkins"}})]),n._v(" "),s("p",[s("strong",[n._v("开始安装了，根据网络情况，安装时间可能会比较长，请耐心等待")]),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins4.png",alt:"jenkins"}})]),n._v(" "),s("p",[s("strong",[n._v("很多插件装不上怎么办？不要慌，记住这些插件的名字，咱们稍后可以手动安装")]),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins5.png",alt:"jenkins"}})]),n._v(" "),s("h2",{attrs:{id:"安装成功效果图"}},[n._v("安装成功效果图")]),n._v(" "),s("p",[n._v("创建管理员\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins6.png",alt:"jenkins"}}),n._v("\n安装完成，进入首页\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins7.png",alt:"jenkins"}})]),n._v(" "),s("h2",{attrs:{id:"附-jenkins-手动安装插件"}},[n._v("附：Jenkins 手动安装插件")]),n._v(" "),s("h4",{attrs:{id:"使用插件管理器安装"}},[n._v("使用插件管理器安装")]),n._v(" "),s("p",[n._v("*"),s("code",[n._v(" Manage Jenkins ")]),n._v("-> "),s("code",[n._v("Manage Plugins ")]),n._v("-> "),s("code",[n._v("Avaliable")]),s("br"),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins8.png",alt:"jenkins"}})]),n._v(" "),s("ul",[s("li",[n._v("过滤出想要安装的插件，然后点击 Download now and install after restart\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins9.png",alt:"jenkins"}})])]),n._v(" "),s("h2",{attrs:{id:"手动上传-hpi-文件"}},[n._v("手动上传 .hpi 文件")]),n._v(" "),s("ul",[s("li",[n._v("点击进入插件中心\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins10.png",alt:"jenkins"}})]),n._v(" "),s("li",[n._v("点击 "),s("code",[n._v("Archives")]),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins11.png",alt:"jenkins"}})]),n._v(" "),s("li",[n._v("下载需要的版本\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins12.png",alt:"jenkins"}})]),n._v(" "),s("li",[n._v("在插件管理器中选择 Advanced\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins13.png",alt:"jenkins"}})]),n._v(" "),s("li",[n._v("选择上传即可\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins14.png",alt:"jenkins"}})])]),n._v(" "),s("h2",{attrs:{id:"重启-jenkins"}},[n._v("重启 Jenkins")]),n._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[n._v("docker-compose")]),n._v(" down\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("docker-compose")]),n._v(" up "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[n._v("-d")]),n._v("\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br")])]),s("p",[s("strong",[n._v("注意：")]),n._v(" 请留意需要下载插件的警告信息，如果不满足安装条件，Jenkins 是会拒绝安装的。如下图：\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins15.png",alt:"jenkins"}})]),n._v(" "),s("h2",{attrs:{id:"配置-jdk-maven"}},[n._v("配置 JDK & Maven")]),n._v(" "),s("ul",[s("li",[s("p",[n._v("上传 JDK 和 Maven 的 tar 包到服务器（容器数据卷目录）")])]),n._v(" "),s("li",[s("p",[n._v("Manage Jenkins -> Global Tool Configuration")])]),n._v(" "),s("li",[s("p",[n._v("安装 JDK（JAVA_HOME 的路径是宿主机目录）")])])]),n._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[n._v("/var/jenkins_home/jdk1.8.0_152\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/img/deployplatform/jenkins16.png",alt:"jenkins"}})]),n._v(" "),s("ul",[s("li",[n._v("安装 JDK（JAVA_HOME 的路径是宿主机目录）")])]),n._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[n._v("/var/jenkins_home/apache-maven-3.5.3\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/img/deployplatform/jenkins17.png",alt:"jenkins"}})]),n._v(" "),s("ul",[s("li",[n._v("别忘记保存")])]),n._v(" "),s("h2",{attrs:{id:"配置本地化-显示中文"}},[n._v("配置本地化（显示中文）")]),n._v(" "),s("ul",[s("li",[s("p",[n._v("安装 "),s("code",[n._v("Locale")]),n._v(" 插件\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins18.png",alt:"jenkins"}})])]),n._v(" "),s("li",[s("p",[s("code",[n._v("Manage Jenkins")]),n._v(" -> "),s("code",[n._v("Configure System")]),n._v(" -> "),s("code",[n._v("Locale")]),n._v(" "),s("img",{attrs:{src:"/img/deployplatform/jenkins19.png",alt:"jenkins"}})])]),n._v(" "),s("li",[s("p",[n._v("本地化效果图\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins20.png",alt:"jenkins"}})])])]),n._v(" "),s("h2",{attrs:{id:"安装动态参数插件"}},[n._v("安装动态参数插件")]),n._v(" "),s("p",[n._v("该插件的主要目的是为了方便我们后面在做项目构建时可以按照版本进行构建（支持一键回滚哦）\n"),s("img",{attrs:{src:"/img/deployplatform/jenkins21.png",alt:"jenkins"}})])])}),[],!1,null,null,null);s.default=t.exports}}]);